1. Склады и остатки. Стичает остатки по складам: общий, в резерве, доступный

SELECT
  w.warehouse_id,
  w.code,
  SUM(i.qty) AS qty_total,
  SUM(i.reserved_qty) AS qty_reserved,
  SUM(i.qty - i.reserved_qty) AS qty_available
FROM public.warehouses w
LEFT JOIN public.inventory i
  ON i.warehouse_id = w.warehouse_id
GROUP BY w.warehouse_id, w.code
ORDER BY qty_available DESC NULLS LAST;







